<core:FragmentDefinition
	xmlns="sap.ui.table"
	xmlns:core="sap.ui.core"
    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"    
    xmlns:r="sap.suite.ui.microchart"
	xmlns:l="sap.ui.layout" 
	xmlns:m="sap.m"
	xmlns:form="sap.ui.layout.form"
	xmlns:fb="sap.ui.comp.filterbar"
    xmlns:ux="sap.uxap"
	xmlns:f="sap.f">
    <l:VerticalLayout>
		
		<form:SimpleForm id="SimpleFormOfertas"
			editable="true"
			layout="ResponsiveGridLayout"
			title="Ofertas">
			
			<form:content>

				<fb:FilterBar id="filterbarOfertas" showGoOnFB="false" showFilterConfiguration="false" persistencyKey="myPersKey" useToolbar="false" search=".onSearch" filterChange=".onFilterChange" >
					<fb:filterGroupItems>
						
						<fb:FilterGroupItem id="filterGroupItemInputOfertas" name="OfertaName" label="Oferta" groupName="Group2" visibleInFilterBar="true">
							<fb:control>
								<m:Input id="inputOfertas" name="Oferta" />												
							</fb:control>
						</fb:FilterGroupItem>

						<fb:FilterGroupItem id="filterGroupItemFechaDesdeOfertas" name="FechaDesde" label="Fecha desde" groupName="Group1" visibleInFilterBar="true">
							<fb:control>
								<m:DatePicker
									id="fechaDesdePickerOfertas"											
									change="onChangeFechaDesde"
									valueFormat="dd/MM/yyyy"
									displayFormat="dd/MM/yyyy" />											
							</fb:control>
						</fb:FilterGroupItem>

						<fb:FilterGroupItem id="filterGroupItemFechaHastaOfertas" name="Fecha" label="Fecha hasta" groupName="Group1" visibleInFilterBar="true">
							<fb:control>
								<m:DatePicker
									id="fechaHastaPickerOfertas"											
									change="handleChange"
									valueFormat="dd/MM/yyyy"
									displayFormat="dd/MM/yyyy"/>											
							</fb:control>
						</fb:FilterGroupItem>
													
					</fb:filterGroupItems>

				</fb:FilterBar>

				<l:VerticalLayout class="sapUiSmallMarginTop" >					
					<m:Button text="Buscar" press="onFilterOfertas"/>
				</l:VerticalLayout>	
					
			</form:content>
		</form:SimpleForm>
		<Table
			id="tableOfertas"						
			rows="{path: '/ZI_PurchaseOrder'}"	
			selectionMode="None">
				<extension>
				<m:OverflowToolbar  style="Clear">
					<m:ToolbarSpacer/>
					
					<m:Input id="inputSearchOfertas"
						placeholder="Buscar" width="10rem" class="sapUiMediumMarginEnd" liveChange="onSearchOfertas" />							
						</m:OverflowToolbar>
				</extension>
				<columns>
					<Column id="columnPedidoOferta" width="7rem" sortProperty="PurchaseOrder" >
						<m:Label id="text2" text="Pedido"/>
						<template>
								<m:Link id="linkPedidoOferta" text="{PurchaseOrder}" press="handleLinkOferta"/>	
						</template>									
					</Column>
					<Column id="columnFecha" width="8rem" sortProperty="CreationDate" >
						<m:Label id="text3"   text="Fecha"/>
						<template>
							<m:Text id="columnText" text="{path:'CreationDate' , formatter:'.formatter.stringDate'}" />
						</template>
					</Column>
					<Column id="columnCampoVendedor" width="10rem" sortProperty="CompanyCode">
						<m:Label id="labelCampoVendedor" text="Campo Vendedor"/>
						<template>
							<m:Text id="textCampoVendedor" text="{CompanyCode}" />								
						</template>
					</Column>
					<Column id="columnTipoPedido" width="10rem" sortProperty="PurchaseOrderType">
						<m:Label id="labelTipoPedido" text="Tipo de Pedido"/>
						<template>
							<m:Text id="columnTextTipoPedido" text="{PurchaseOrderType}" />								
						</template>
					</Column>
					<Column id="columnMoneda" sortProperty="DocumentCurrency" width="5rem">
						<m:Label id="labelMoneda" text="Moneda"/>
						<template>
							<m:Text id="textMoneda" text="{DocumentCurrency}" />								
						</template>
					</Column>
					<Column id="columnValorNetoOferta" sortProperty="to_PurchaseOrderItem/results/0/NetAmount" >
					<m:Label id="textValorNeto" text="Valor Neto"/>
					<template>
						<m:Text id="columnTextValorNetoOferta" text="{path:'to_PurchaseOrderItem/results/0/NetAmount' , formatter:'.formatter.removeZeros'}" />
					</template>
					</Column>
					<Column id="columnBloqueadoOferta" width="7rem" sortProperty="PurchasingProcessingStatus">
						<m:Label id="labelBloqueadoOferta" text="Bloqueado"/>
						<template>
							<m:Text id="textBloqueadoOferta" text="{PurchasingProcessingStatus}" />							
						</template>
					</Column>
					<Column id="columnEstadoOferta" width="6rem" sortProperty="PurchasingCompletenessStatus" >
						<m:Label id="labelEstadoOferta" text="Estado" />
						<template>
								<m:ObjectStatus class="sapUiSmallMarginBegin" id="statusOferta"		
								icon="{path:'PurchasingCompletenessStatus' , formatter:'.formatter.statusIcon'}"
								state="{path:'PurchasingCompletenessStatus' , formatter:'.formatter.statusColor'}" />
						</template>
					</Column>
				</columns>						
		</Table>
	</l:VerticalLayout>
</core:FragmentDefinition>